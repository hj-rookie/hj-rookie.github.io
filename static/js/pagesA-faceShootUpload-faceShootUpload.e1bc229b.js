(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesA-faceShootUpload-faceShootUpload"],{"2b29":function(t,e,a){var i=a("e955");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("4f06").default;r("34b88fa5",i,!0,{sourceMap:!1,shadowMode:!1})},4118:function(t,e,a){"use strict";a.r(e);var i=a("48c7"),r=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},"48c7":function(t,e,a){"use strict";var i=a("4ea4");a("ac1f"),a("841c"),a("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var r,n=i(a("1da1")),o=i(a("5530")),s=a("26cb"),c=a("8e55"),l=i(a("0a34")),d=(0,s.createNamespacedHelpers)("factor"),u=d.mapState,f=d.mapMutations,v=0,p={data:function(){return{PICTURE_URL:c.PICTURE_URL,isRecording:!1,isCameraError:!1,helperText:"按住拍摄",labelDuration:0,isHuaWei:!0}},computed:(0,o.default)((0,o.default)({},u(["lifeData","faceFromFlags"])),{},{labels:function(){var t=this.lifeData;return t.label?t.label.split(""):[]}}),onLoad:function(t){},onShow:function(){var t=this;uni.getSetting({success:function(e){var a=e.authSetting["scope.record"];a?!0===a&&(t.isCameraError=!1):uni.authorize({scope:"scope.record",fail:function(){t.isCameraError=!0}})}}),uni.getSystemInfo({success:function(e){var a=e.brand;t.isHuaWei=-1!==a.search("HUAWEI")}})},methods:(0,o.default)((0,o.default)({},f(["updateLifeData"])),{},{onCancel:function(){l.default.navigateBack()},onTouchEnd:function(){if(!this.isTaking)return clearTimeout(this.tapTakeTimer),this.tapTakeTimer=null,this.isRecording=!1,this.helperText="请按住按钮进行拍摄",void this.stopLabelTimer();this.doStopRecord()},onTapTakeBtn:function(){var t=this;this.isRecording=!0,this.helperText="松手停止",this.$track.setStartTime("face_recognition_time"),this.tapTakeTimer=setTimeout((function(){t.doStartRecord()}),100),this.startLabelTimer()},doStartRecord:function(){this.isTaking||(this.isTaking=!0,this.startRecord())},doStopRecord:function(){this.isTaking=!1,v<2?(this.isRecording=!1,this.helperText="时长太短，请重新拍摄",this.clearTimer()):v>6?(this.isRecording=!1,this.helperText="时长太长，请重新拍摄",this.clearTimer()):this.stopRecord(),this.stopLabelTimer()},startLabelTimer:function(){var t=this;r=setInterval((function(){t.labelDuration++}),1e3)},stopLabelTimer:function(){clearInterval(r),r=null,this.labelDuration=0},onCameraError:function(){this.isCameraError=!0},onCameraDone:function(){this.isCameraError=!1},onOpenSetting:function(){var t=this;uni.openSetting({success:function(e){t.isCameraError=!1}})},stopRecord:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=uni.createCameraContext(),a.stopRecord({compressed:!0,success:function(){var e=(0,n.default)(regeneratorRuntime.mark((function e(a){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=a.tempVideoPath,r={resource_type:"submit",resource_value:"sbt_bioassay",event_result:"success",page_name:"活体检测"},t.$track.dataPost(r),t.updateLifeData({filePath:i}),t.$track.setInputTime("face_recognition_time"),t.$track.setCacheData("face_recognition_time"),l.default.navigateTo("faceUploadLoading",{subcontract:"A"},!0),t.clearTimer();case 8:case"end":return e.stop()}}),e)})));function a(t){return e.apply(this,arguments)}return a}(),fail:function(e){var a={resource_type:"submit",resource_value:"sbt_bioassay",event_result:"fail",page_name:"活体检测"};t.$track.dataPost(a),l.default.log(e),t.isRecording=!1,t.clearTimer()},complete:function(){t.isTaking=!1}});case 2:case"end":return e.stop()}}),e)})))()},startRecord:function(){},startTimer:function(){this.clearTimer(),this.recordTimer=setInterval((function(){v++}),1e3)},clearTimer:function(){v=0,this.recordTimer&&(clearInterval(this.recordTimer),this.recordTimer=null)}})};e.default=p},5950:function(t,e,a){"use strict";var i=a("2b29"),r=a.n(i);r.a},"751a":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var i={navBar:a("b560").default},r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{},[a("nav-bar",{attrs:{backgroundColor:"#5c5c5c",color:"#ffffff",title:"人脸识别"}}),a("v-uni-view",{staticClass:"container"},[t.isCameraError?a("v-uni-view",{staticClass:"fail-box"},[a("v-uni-view",{staticClass:"fail-title"},[a("v-uni-text",{staticClass:"fs-32"},[t._v("调用摄像头失败")])],1),a("v-uni-view",{staticClass:"fail-content"},[a("v-uni-text",{staticClass:"desc fs-28 color-gray"},[t._v("请授权我们使用摄像头和录音的权限，否则将无法完成此功能。")]),a("v-uni-button",{staticClass:"fs-32",staticStyle:{color:"#4091F1","margin-top":"30upx"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpenSetting.apply(void 0,arguments)}}},[t._v("重新授权")])],1)],1):t._e(),a("v-uni-view",{staticClass:"camera-wrap",attrs:{"wx:else":!0}},[a("v-uni-view",{staticClass:"camera-box",class:t.isHuaWei?"small":""}),a("v-uni-view",{staticClass:"camera-controls"},[a("v-uni-view",{staticClass:"helper"},[t._v("保持正脸对准摄像头朗读以下数字")]),a("v-uni-view",{staticClass:"label-view"},t._l(t.labels,(function(e,i){return a("v-uni-text",{key:e,class:t.labelDuration>i?"focus":""},[t._v(t._s(e))])})),1),a("v-uni-view",{staticClass:"recording show"},[t._v(t._s(t.helperText))]),a("v-uni-view",{staticClass:"take-btn flex-box align-center justify-center",class:t.isRecording?"btn-recording":"",attrs:{"hover-class":"take-btn-hover"},on:{touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.onTouchEnd.apply(void 0,arguments)},touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.onTapTakeBtn.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"inner flex-box align-center justify-center"},[a("v-uni-view",{staticClass:"wave-view"}),a("v-uni-view",{staticClass:"wave-view delay"}),a("v-uni-text",{staticClass:"color-primary fs-32"},[t._v(t._s(t.isRecording?"停止":"拍摄"))])],1)],1),a("v-uni-view",{staticClass:"take-btn flex-box align-center justify-center",attrs:{hidden:"true","hover-class":"take-btn-hover"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onToggleRecord.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"inner flex-box align-center justify-center"},[a("v-uni-text",{staticClass:"color-primary fs-32"},[t._v(t._s(t.isRecording?"停止":"拍摄"))])],1)],1)],1)],1)],1)],1)},n=[]},b1c5:function(t,e,a){"use strict";a.r(e);var i=a("751a"),r=a("4118");for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("5950");var o,s=a("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"4d0dc955",null,!1,i["a"],o);e["default"]=c.exports},e955:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,".container[data-v-4d0dc955]{border:0}.camera-wrap[data-v-4d0dc955]{width:100%;height:100vh;overflow:hidden;position:relative;background-color:#5c5c5c}.camera-box[data-v-4d0dc955]{top:%?140?%;left:50%;width:%?544?%;height:%?740?%;position:absolute;margin-left:%?-272?%}.camera-box.small[data-v-4d0dc955]{width:%?500?%;height:%?640?%;margin-left:%?-250?%}.camera-controls[data-v-4d0dc955],\n.camera-box uni-camera[data-v-4d0dc955],\n.camera-box uni-cover-image[data-v-4d0dc955]{width:100%;height:100%}.helper[data-v-4d0dc955],\n.label-view[data-v-4d0dc955]{top:0;color:#fff;width:100%;font-size:%?34?%;text-align:center;position:absolute}.camera-controls .cancel-btn[data-v-4d0dc955]{top:0;left:0;width:%?160?%;text-align:center;position:absolute}.label-view[data-v-4d0dc955]{top:%?70?%}.camera-controls .take-btn[data-v-4d0dc955]{left:50%;bottom:%?310?%;width:%?146?%;height:%?146?%;position:absolute;border-radius:100%;margin-left:%?-73?%;transition:all .2s ease;background-color:hsla(0,0%,100%,.6)}.take-btn.take-btn-hover[data-v-4d0dc955]{\n  /* transform: scale(.98); */background-color:rgba(222,183,114,.6)}.camera-controls .take-btn .inner[data-v-4d0dc955]{width:%?122?%;height:%?122?%;position:relative;border-radius:100%;background-color:#fff}@-webkit-keyframes wave-data-v-4d0dc955{from{opacity:.5;-webkit-transform:scale(0);transform:scale(0)}90%{opacity:0;-webkit-transform:scale(2);transform:scale(2)}100%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}@keyframes wave-data-v-4d0dc955{from{opacity:.5;-webkit-transform:scale(0);transform:scale(0)}90%{opacity:0;-webkit-transform:scale(2);transform:scale(2)}100%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}.wave-view[data-v-4d0dc955]{top:0;left:0;right:0;bottom:0;display:none;position:absolute;border-radius:100%;background-color:#fff;-webkit-animation:wave-data-v-4d0dc955 1s infinite;animation:wave-data-v-4d0dc955 1s infinite}.wave-view.delay[data-v-4d0dc955]{-webkit-animation-delay:.2s;animation-delay:.2s}.btn-recording .wave-view[data-v-4d0dc955]{display:block}.recording[data-v-4d0dc955]{opacity:0;width:100%;color:#fff;bottom:%?490?%;font-size:%?34?%;text-align:center;position:absolute;transition:opacity 1s ease}.recording.show[data-v-4d0dc955]{opacity:1}.btn-recording[data-v-4d0dc955]{-webkit-transform:scale(1.3);transform:scale(1.3)}.label-view[data-v-4d0dc955]{color:#fff;font-size:%?48?%;margin-left:%?10?%;letter-spacing:%?20?%}.label-view uni-text[data-v-4d0dc955]{display:inline-block;transition:color .3s ease}.label-view uni-text.focus[data-v-4d0dc955]{color:#3d90f1}",""]),t.exports=e}}]);