(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesA-tradePasswordSet-tradePasswordSet"],{"1c45":function(e,a,t){"use strict";t.d(a,"b",(function(){return s})),t.d(a,"c",(function(){return r})),t.d(a,"a",(function(){return n}));var n={navBar:t("b560").default},s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-uni-view",{staticClass:"container"},[t("nav-bar",{attrs:{title:"设置交易密码",customLeftEvent:!0},on:{clickLeft:function(a){arguments[0]=a=e.$handleEvent(a),e.onPageBack.apply(void 0,arguments)}}}),"sign"===e.pageFrom?t("v-uni-view",{staticClass:"trade-top flex-box align-center justify-center flex-column"},[t("v-uni-icon",{staticClass:"mb-28",attrs:{type:"success",size:"68",color:"#448bfd"}}),t("v-uni-view",{staticClass:"fs-30 color-gray"},[e._v("绑卡成功！")]),t("v-uni-view",{staticClass:"fs-30 color-gray"},[e._v("为了您的账户安全，请设置交易密码")])],1):t("v-uni-view",{staticClass:"trade-top flex-box align-center justify-center flex-column",staticStyle:{height:"100upx"}},[t("v-uni-view",{staticClass:"fs-30 color-gray"},[e._v("为了您的账户安全，请设置交易密码")])],1),e.KBSWITCH&&"chengde"===e.bank_mark?t("safe-board",{ref:"skb1",attrs:{type:"restt",id:"skb1",keyboardType:"number",label:e.label,keyboardNumber:"2",placeholder:"6位数字密码组合"},on:{onDone:function(a){arguments[0]=a=e.$handleEvent(a),e.onDone.apply(void 0,arguments)},show:function(a){arguments[0]=a=e.$handleEvent(a),e.show.apply(void 0,arguments)},hide:function(a){arguments[0]=a=e.$handleEvent(a),e.$handleTrackBlur("set_tranpassword_intime")}}}):"taian"===e.bank_mark||"linshang"===e.bank_mark?t("v-uni-view",{staticClass:"form-control lr"},[t("v-uni-view",{staticClass:"form-item"},[t("v-uni-view",{staticClass:"label"},[e._v("交易密码")]),t("v-uni-view",{staticClass:"value"},[t("v-uni-view",{staticClass:"flex-box align-center justify-end"},[t("v-uni-view",["taian"===e.bank_mark?t("taian-safekeyboard",{ref:"taiankeyboardRef",attrs:{sktype:1,index:1},on:{close:function(a){arguments[0]=a=e.$handleEvent(a),e.onClose.apply(void 0,arguments)},change:function(a){arguments[0]=a=e.$handleEvent(a),e.onPwChange.apply(void 0,arguments)}}}):e._e(),t("v-uni-view",{staticClass:"input-item pwd-input flex-box align-center input-class"},[t("v-uni-input",{attrs:{disabled:!0,password:!0,maxlength:"6",type:"number",placeholder:"输入6位交易密码",value:e.p1,"placeholder-class":"input-placeholder"},on:{input:function(a){arguments[0]=a=e.$handleEvent(a),e.handleInputChange(a,e.item)},focus:function(a){arguments[0]=a=e.$handleEvent(a),e.$handleTrackFocus("set_tranpassword_intime")},blur:function(a){arguments[0]=a=e.$handleEvent(a),e.$handleTrackBlur("set_tranpassword_intime")},click:function(a){arguments[0]=a=e.$handleEvent(a),e.taianShowKeyboard.apply(void 0,arguments)}}})],1)],1)],1)],1)],1),t("v-uni-view",{staticClass:"form-item"},[t("v-uni-view",{staticClass:"label"},[e._v("交易密码确认")]),t("v-uni-view",{staticClass:"value"},[t("v-uni-view",{staticClass:"flex-box align-center justify-end"},[t("v-uni-view",["taian"===e.bank_mark?t("taian-safekeyboard",{ref:"taiankeyboard",attrs:{sktype:1,index:2},on:{close:function(a){arguments[0]=a=e.$handleEvent(a),e.onClose.apply(void 0,arguments)},change:function(a){arguments[0]=a=e.$handleEvent(a),e.onPwChange.apply(void 0,arguments)}}}):e._e(),t("v-uni-view",{staticClass:"input-item pwd-input flex-box align-center input-class"},[t("v-uni-input",{attrs:{disabled:!0,password:!0,maxlength:"6",type:"number",placeholder:"输入6位交易密码",value:e.p2,"placeholder-class":"input-placeholder"},on:{input:function(a){arguments[0]=a=e.$handleEvent(a),e.handleInputChange(a,e.item)},focus:function(a){arguments[0]=a=e.$handleEvent(a),e.$handleTrackFocus("set_tranpassword_intime")},blur:function(a){arguments[0]=a=e.$handleEvent(a),e.$handleTrackBlur("set_tranpassword_intime")},click:function(a){arguments[0]=a=e.$handleEvent(a),e.taianShowKeyboard1.apply(void 0,arguments)}}})],1)],1)],1)],1)],1)],1):t("v-uni-view",{staticClass:"form-control lr"},e._l(e.inputList,(function(a){return t("v-uni-view",{key:a,staticClass:"form-item"},[t("v-uni-view",{staticClass:"label"},"1"===a?[e._v("交易密码")]:[e._v("交易密码确认")]),t("v-uni-view",{staticClass:"value"},[t("v-uni-view",{staticClass:"flex-box align-center justify-end"},[t("v-uni-view",[t("v-uni-view",{staticClass:"input-item pwd-input flex-box align-center input-class"},[t("v-uni-input",{attrs:{password:!0,maxlength:"6",type:"number",placeholder:"请输入交易密码",value:e.tradePassword(a),"placeholder-class":"input-placeholder"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleInputChange(t,a)},focus:function(a){arguments[0]=a=e.$handleEvent(a),e.$handleTrackFocus("set_tranpassword_intime")},blur:function(a){arguments[0]=a=e.$handleEvent(a),e.$handleTrackBlur("set_tranpassword_intime")}}})],1)],1)],1)],1)],1)})),1),t("v-uni-view",{staticClass:"submit-btn-wrap page-space"},[t("v-uni-button",{staticClass:"button block-button",attrs:{loading:e.loading,disabled:e.loading},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.handleSubmit.apply(void 0,arguments)}}},[e._v("完成")])],1)],1)},r=[]},"318b":function(e,a,t){"use strict";var n=t("e5cb"),s=t.n(n);s.a},3676:function(e,a,t){"use strict";t.r(a);var n=t("1c45"),s=t("3a1e");for(var r in s)"default"!==r&&function(e){t.d(a,e,(function(){return s[e]}))}(r);t("318b");var i,o=t("f0c5"),u=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"b6fa4730",null,!1,n["a"],i);a["default"]=u.exports},"3a1e":function(e,a,t){"use strict";t.r(a);var n=t("50b7"),s=t.n(n);for(var r in n)"default"!==r&&function(e){t.d(a,e,(function(){return n[e]}))}(r);a["default"]=s.a},"50b7":function(e,a,t){"use strict";var n=t("4ea4");t("99af"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var s=n(t("ade3"));t("96cf");var r=n(t("1da1")),i=n(t("5530")),o=t("26cb"),u=n(t("0a34")),c=n(t("8e55")),d=n(t("8be5")),l=(0,o.createNamespacedHelpers)("password"),p=l.mapState,f=(l.mapGetters,l.mapActions),v=l.mapMutations,b=(0,o.createNamespacedHelpers)("target"),h=(0,o.createNamespacedHelpers)("user"),m=(0,o.createNamespacedHelpers)("home"),w={components:{"taian-safekeyboard":d.default},data:function(){return{pageFrom:"",inputList:["1","2"],loading:!1,type:"",plarrjy:["输入6位交易密码","输入6位交易密码"],KBSWITCH:c.default.KBSWITCH,bank_mark:c.default.BANK_KB,p1:"",p2:""}},computed:(0,i.default)((0,i.default)((0,i.default)((0,i.default)({},p({tradePassword:function(e){return function(a){return e.tradePassword.set["p"+a]}}})),h.mapState(["base64ServerRandom"])),b.mapState(["targetData"])),{},{label:function(){return function(e){var a="交易";return[a,1==e?"密码":"密码确认"].join("")}},pageTrackData:function(){return{page_id:"set_pwd",page_name:"设置交易密码"}}}),onLoad:function(e){this.pageFrom=e.from||"",this.type=e.type||""},onShow:function(){this.$refs.skb1.clear(),this.loading=!1,this.base64EncryptedData="",this.base64EncryptedRc=""},methods:(0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)((0,i.default)({},v(["updatePassword"])),f(["setTradePassword"])),b.mapMutations(["clearTargetData","updateTargetData"])),h.mapActions(["getKeyboardNumber"])),m.mapMutations({homeDataChange:"update"})),{},{getTrackData:function(){return(0,i.default)({resource_type:"user",resource_uri:"form_setpassw"},this.pageTrackData)},clearTnPw:function(){"taian"===this.bank_mark&&(this.$refs.taiankeyboardRef.safekey_bindCancle(),this.$refs.taiankeyboard.safekey_bindCancle(),this.updatePassword({type:"trade",key:"set",value:{p1:"",p2:""}}),this.p1="",this.p2="")},handleSubmit:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var t,n,s,r,o,c,d,l,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t=e.getTrackData(),n="fail",s="",e.KBSWITCH&&"chengde"===e.bank_mark?e.base64EncryptedData&&-3!==e.base64EncryptedData?-1===e.base64EncryptedData?s="请输入6位数字密码":e.base64EncryptedData&&-4!==e.base64EncryptedData?-2===e.base64EncryptedData&&(s="两次密码输入不一致，请重新输入",e.$refs.skb1.clear(),e.loading=!1,e.base64EncryptedData="",e.base64EncryptedRc=""):(s="密码强度弱请重新输入",e.$refs.skb1.clear(),e.loading=!1,e.base64EncryptedData="",e.base64EncryptedRc=""):s="请输入交易密码":("taian"===e.bank_mark||"linshang"===e.bank_mark)&&(""===e.p1||""===e.p2?s="请输入交易密码":(e.p1.length<6||e.p2.length<6)&&(s="请输入6位数字密码")),!s){a.next=7;break}return u.default.alert({content:s,onSuccess:function(){e.clearTnPw()}}),a.abrupt("return");case 7:return e.loading=!0,a.next=10,e.setTradePassword({base64EncryptedData:e.base64EncryptedData,base64EncryptedRc:e.base64EncryptedRc});case 10:if(r=a.sent,e.$track.setData({resource_value:"finish_password"}),!r){a.next=44;break}if(!r.isError){a.next=17;break}u.default.alert({content:r.message}),a.next=44;break;case 17:if("2077"!==r.code){a.next=21;break}u.default.alert({content:r.message,onSuccess:function(){e.$refs.skb1.clear(),e.loading=!1,e.base64EncryptedData="",e.base64EncryptedRc="",e.clearTnPw()}}),a.next=44;break;case 21:if("1000"===r.code){a.next=25;break}e.clearTnPw(),a.next=44;break;case 25:if(o=r.data,!o){a.next=43;break}if(n="success",e.updatePassword({key:"set",value:{p1:"",p2:""}}),e.homeDataChange({passFlag:"1"}),c=e.targetData,t.event_result=n,"mycard"!==e.pageFrom){a.next=36;break}return u.default.navigateTo("bindCard",{type:"bind",typeT:"userBind",fromType:"userBind",pageFrom:"mycard",pageFromS:"tradePasswordSet"}),setTimeout((function(){e.loading=!1}),500),a.abrupt("return");case 36:t.event_code="sbt_setpwd",t.resource_value="sbt_setpwd",t.resource_type="submit",e.$track.dataPost(t),c&&c.tradePasswordSet?(e.clearTargetData(),d=c.tradePasswordSet.to||"newLoan",u.default.navigateTo(d,"newLoan"===d?{subcontract:"B"}:{},!0)):"sign"===e.pageFrom?(u.default.navigateTo("newLoan",{type:"passW",subcontract:"B"},!0),setTimeout((function(){e.loading=!1}),500)):"mycard"===e.pageFrom?(u.default.navigateTo("bindCard",{type:"bind",typeT:"userBind",fromType:"userBind",pageFrom:"mycard",pageFromS:"tradePasswordSet"}),setTimeout((function(){e.loading=!1}),500)):u.default.navigateBack(),a.next=44;break;case 43:u.default.alert({content:"设置交易密码失败"});case 44:l=wx.getStorageSync("userInfo"),p={org_id:"12345",eventType:"06",mobile:l.mobile?l.mobile:e.mobile,uuid:l.uuid,id_umber:l.idNumber,name:l.name},p.event_code="sbt_setpwd",p.resource_value="sbt_setpwd",p.resource_type="submit",e.$track.dmActionPost((0,i.default)((0,i.default)({},p),t)),e.loading=!1;case 51:case"end":return a.stop()}}),a)})))()},show:function(e){this.$handleTrackFocus("set_tranpassword_intime"),this.cb=e,this.getRandom()},onDone:function(e){this.base64EncryptedData=e.value,this.base64EncryptedRc=e.encryptRandomData},onChange:function(e,a,t){this.logData="\n输入ID".concat(e,"输入类型").concat(a,"输入长度").concat(t,"\n").concat(this.logData)},myevent:function(e){var a=this;return(0,r.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.getRandom();case 2:e.detail();case 3:case"end":return t.stop()}}),t)})))()},onPasswordChange:function(e){this.base64EncryptedData=e.detail.value,this.base64EncryptedRc=e.detail.random},taianShowKeyboard:function(){this.$refs.taiankeyboardRef.safekey_open()},taianShowKeyboard1:function(){this.$refs.taiankeyboard.safekey_open()},onPwChange:function(e){1===e.index?(this.updatePassword({type:"trade",key:"set",value:{p1:e.uuid}}),this.p1=e.pwd):(this.updatePassword({type:"trade",key:"set",value:{p2:e.uuid}}),this.p2=e.pwd)},onClose:function(e){1===e.index?(this.updatePassword({key:"set",value:{p1:""}}),this.p1=""):(this.updatePassword({key:"set",value:{p2:""}}),this.p2="")},getRandom:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var t;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.getKeyboardNumber({busType:"1"});case 3:t=a.sent,t&&e.cb&&e.cb(t.data.pwdCode),a.next=9;break;case 7:a.prev=7,a.t0=a["catch"](0);case 9:return a.prev=9,e.loading=!1,uni.hideLoading(),a.finish(9);case 13:case"end":return a.stop()}}),a,null,[[0,7,9,13]])})))()},showKeybaoard:function(){this.$handleTrackBlur("login_pwd_intime")},handleInputChange:function(e,a){this.updatePassword({key:"set",value:(0,s.default)({},"p"+a,e.detail.value)}),this.$handleTrackChange(e,"set_tranpassword_incode")},onPageBack:function(){if("set"===this.type||"sign"===this.pageFrom||"mycard"===this.pageFrom)uni.navigateBack({});else{var e=this.targetData;if(e&&e.tradePasswordSet)return void uni.navigateBack({});u.default.navigateTo("index")}}})};a.default=w},d525:function(e,a,t){var n=t("24fb");a=n(!1),a.push([e.i,".trade-top[data-v-b6fa4730]{height:%?480?%}.submit-btn-wrap[data-v-b6fa4730]{margin-top:%?134?%}.tp-input[data-v-b6fa4730]{width:%?476?%!important}",""]),e.exports=a},e5cb:function(e,a,t){var n=t("d525");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var s=t("4f06").default;s("7d26488c",n,!0,{sourceMap:!1,shadowMode:!1})}}]);