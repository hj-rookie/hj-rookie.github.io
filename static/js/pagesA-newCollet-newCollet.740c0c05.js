(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesA-newCollet-newCollet"],{"5da6":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}));var n={navBar:a("b560").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"container top-border",staticStyle:{"background-color":"#FFFFFF"}},[a("nav-bar",{attrs:{title:"人脸识别"}}),a("v-uni-view",{staticClass:"check-msg"},[a("v-uni-view",{staticClass:"title fs-28"},[a("v-uni-text",{staticClass:"title fs-28",staticStyle:{"font-weight":"bold"}},[e._v("即将拍摄您本人人脸，请确保正对手机，光线充足")])],1),a("v-uni-view",{staticClass:"fs-28",staticStyle:{color:"#888888","text-align":"center","margin-top":"16upx"}},[e._v("防范别人操作，保障账户安全")]),a("v-uni-view",{staticClass:"intro",staticStyle:{"margin-top":"60upx"}},[a("v-uni-image",{attrs:{src:e.PICTURE_URL+"rlsb_img@2x.png"}})],1)],1),a("v-uni-view",{staticClass:"submit-btn-wrap page-space",staticStyle:{position:"relative"}},[a("v-uni-view",{ref:"input",staticClass:"input",staticStyle:{position:"absolute",bottom:"0",width:"100%",height:"94upx","z-index":"100",opacity:"0"}}),a("v-uni-button",{staticClass:"button block-button button-can",attrs:{"data-track-type":"count",disabled:e.loading,"hover-class":"button-hover","data-track-id":"FaceRecognitionTimes"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onElementClick.apply(void 0,arguments)}}},[e._v("开始录制视频")])],1)],1)},r=[]},6061:function(e,t,a){var n=a("e8b6");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("9d316a2c",n,!0,{sourceMap:!1,shadowMode:!1})},"69f5":function(e,t,a){"use strict";a.r(t);var n=a("5da6"),i=a("a615");for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);a("e60f");var o,c=a("f0c5"),s=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"b5904f6a",null,!1,n["a"],o);t["default"]=s.exports},a615:function(e,t,a){"use strict";a.r(t);var n=a("c928"),i=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},c928:function(e,t,a){"use strict";var n=a("4ea4");a("c19f"),a("ace4"),a("d3b7"),a("ac1f"),a("3ca3"),a("466d"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("2954"),a("649e"),a("219c"),a("b39a"),a("72f7"),a("ddb0"),a("2b3d"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var i=n(a("1da1")),r=n(a("5530")),o=a("26cb"),c=n(a("0a34")),s=a("8e55"),u=n(a("e410")),d=n(a("eed6")),l=(0,o.createNamespacedHelpers)("factor"),f=l.mapState,p=(l.mapGetters,l.mapActions),g=l.mapMutations,m=(0,o.createNamespacedHelpers)("result"),h=(0,o.createNamespacedHelpers)("verify"),v=(0,o.createNamespacedHelpers)("loan"),b=(0,o.createNamespacedHelpers)("card"),w={ocr:"change_edentify",changeMobile:"change_mobile",resetTradePassword:"reset_trade_password",credit:"credit",loan:"loan"},C="credit",k="",y="",_={data:function(){return{pageId:"",loading:!1,firstLoad:!0,locationS:!0,goCredit:!1,PICTURE_URL:s.PICTURE_URL}},computed:(0,r.default)((0,r.default)({},f(["lifeData"])),{},{pageTrackData:function(){return{page_id:"bioassay",page_name:"活体检测",face_recognition_camera_direction:"0"}}}),watch:{"lifeData.filePath":function(e,t){var a=this;return(0,i.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=7;break}if(c.default.log("000000000"+e),a.$track.setData({resource_value:"vidio_start"}),"credit"!==C&&"loan"!==C&&"bindCard"!==C&&"resetTradePassword"!==C&&"unbindCard"!==C){t.next=6;break}return t.next=6,uni.navigateTo({url:"../../pagesA/liveLoding/liveLoding"});case 6:a.uploadFile();case 7:case"end":return t.stop()}}),t)})))()}},onLoad:function(e){C=e.type||C,k=e.fromType||"",y=e.pageFromS,this.pageId=w[C]},onUnload:function(){C="credit",clearTimeout(this.loginTimer),this.loginTimer=null},onHide:function(){this.$track.setCacheData("collect")},onShow:function(){this.$track.applyCacheData("credit"),this.$track.applyCacheData("collData"),this.goCredit&&c.default.alert({content:"您已连续活体检测失败3次，请重新提交身份证信息",onSuccess:function(){c.default.navigateTo("credit",{subcontract:"A"},!0)}})},mounted:function(){var e=document.createElement("input");e.style.width="100%",e.style.height="100%",e.type="file",e.id="file",e.accept="video/*",e.capture="user";var t=this;this.$refs.input.$el.appendChild(e),e.onchange=function(a){var n=a.target.value;if(""!==n){n=e.files[0];var i=new FileReader;i.readAsDataURL(n),i.onload=function(){var e=t.convertBase64UrlToBlob(i.result,n.type),a=URL.createObjectURL(e);t.updateLifeData({filePath:a})},e.value=""}}},methods:(0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)({},p(["online","checkToken","creditApply","getReadLabel","uploadLifeVideo"])),b.mapActions(["doBindCard","bankCardUnBind","bindOtherCard"])),b.mapMutations(["updateBindCardData","clearBindCardData"])),g(["updateLifeData"])),v.mapActions(["loanApply"])),m.mapMutations({updateResult:"update"})),h.mapActions(["noticeAuthCheck"])),{},{onElementClick:function(){var e=this;this.loginTimer&&(clearTimeout(this.loginTimer),this.loginTimer=null),this.loginTimer=setTimeout((function(){"credit"!==C?e.btnClcik():e.onNetline()}),200)},btnClcik:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return uni.hideLoading(),e.getCheckgetToken(),e.$track.setCountData("face_recognition_times"),e.$track.setCacheData("collData"),e.goPAGE(),t.abrupt("return");case 7:case"end":return t.stop()}}),t)})))()},goPAGE:function(){var e=navigator.userAgent;navigator.appVersion;e.match(/AppleWebKit.*Mobile.*/)||e.match(/AppleWebKit/)},convertBase64UrlToBlob:function(e,t){for(var a=window.atob(e.split(",")[1]),n=new ArrayBuffer(a.length),i=new Uint8Array(n),r=0;r<a.length;r++)i[r]=a.charCodeAt(r);return new Blob([n],{type:t})},onNetline:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return uni.showLoading({title:"请稍候..."}),t.prev=1,t.next=4,e.online();case 4:a=t.sent,a&&"1000"===a.code?e.btnClcik():!a||"8011"!==a.code||"credit"!==C&&"resetTradePassword"!==C?a&&"2042"===a.code&&c.default.alert({content:a.message,onSuccess:function(){e.$track.setData({resource_value:"vidio_start"}),c.default.navigateTo("credit",{subcontract:"A"},!0)}}):c.default.alert({content:"您已连续人脸识别失败3次，请重新提交身份证信息",onSuccess:function(){e.$track.setData({resource_value:"credit"}),c.default.navigateTo("credit",{subcontract:"A"},!0)}}),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](1);case 10:case"end":return t.stop()}}),t,null,[[1,8]])})))()},getCheckgetToken:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return"credit"!==C&&uni.showLoading({title:"正在加载",mask:!0}),t.prev=1,t.next=4,e.checkToken();case 4:t.next=8;break;case 6:t.prev=6,t.t0=t["catch"](1);case 8:uni.hideLoading();case 9:case"end":return t.stop()}}),t,null,[[1,6]])})))()},dmActionPost:function(){var e=wx.getStorageSync("userInfo"),t={org_id:"12345",eventType:"03",mobile:e.mobile,uuid:e.uuid?e.uuid:""};d.default.post("customService/antiFraudEvent",{disableAlert:!0,data:t})},doCredit:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=uni.getStorageSync("locationData"),t.next=3,e.creditApply({position_y:a&&a.location?a.location.lat:"",position_x:a&&a.location?a.location.lng:"",province:a&&a.address_component?a.address_component.province:"",city:a&&a.address_component?a.address_component.city:"",district:a&&a.address_component?a.address_component.district:"",addressDetail:a&&a.address?a.address:""});case 3:n=t.sent,e.$track.dataPost(),n&&"1000"===n.code?(uni.$emit("success",{msg:k,title:"提交申请"}),e.$track.clearExtendData()):n&&"8011"===n.code&&"credit"===C?uni.$emit("fail",{msg:"creditFailThree"}):!n||"请求超时"!==n&&"5004"!==n.code?uni.$emit("fail",{msg:"creditFail"}):uni.$emit("fail",{msg:"creditFailTimeout"}),e.$track.clearData(),uni.hideLoading();case 8:case"end":return t.stop()}}),t)})))()},postLoanData:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=uni.getStorageSync("loanData"),n.pwdCode=e.data.pwdCode,a.next=4,t.loanApply(n);case 4:i=a.sent,i&&"1"===i.data.resultFlag?(t.$track.dataPost({resource_type:"submit",resource_value:"sbt_loan",event_result:"success"}),uni.$emit("success",{msg:k,type:"loan"})):(t.$track.dataPost({resource_type:"submit",resource_value:"sbt_loan",event_result:"fail"}),uni.$emit("fail",{msg:"loan"}));case 6:case"end":return a.stop()}}),a)})))()},postbindData:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=uni.getStorageSync("bindData"),n.pwdCode=e.data.pwdCode,n.isPost=!0,a.next=5,t.doBindCard(n);case 5:i=a.sent,i&&"1"===i.data.resultFlag?"0"===n.isOwnerCard?t.postOtherCardData():(uni.$emit("success",{msg:k,type:"bindCard",pageFromS:y}),t.clearBindCardData()):(uni.$emit("fail",{msg:"bindCard",pageFromS:y}),t.clearBindCardData());case 7:case"end":return a.stop()}}),a)})))()},postOtherCardData:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=uni.getStorageSync("bindData"),e.next=3,t.bindOtherCard(a);case 3:n=e.sent,"1000"===n.code?(t.updateBindCardData({url:n.url,flowNo:n.flowNo}),c.default.navigateTo("thirdParty",{url:n.url,type:"bind",subcontract:!0},!0)):c.default.alert({content:n.message});case 5:case"end":return e.stop()}}),e)})))()},postunbindData:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=uni.getStorageSync("unbindData"),n.pwdCode=e.data.pwdCode,a.next=4,t.bankCardUnBind(n);case 4:i=a.sent,i&&"1"===i.data.resultFlag?uni.$emit("success",{msg:k,type:"unbindCard"}):uni.$emit("fail",{msg:"unbindCard"});case 6:case"end":return a.stop()}}),a)})))()},doSuccess:function(e){var t=this;"credit"===C?u.default.getLocation((function(e){t.doCredit()}),(function(){uni.$emit("fail",{msg:"locationFail"})}),!1,!0):"loan"===C?this.postLoanData(e):"bindCard"===C?this.postbindData(e):"unbindCard"===C?this.postunbindData(e):"ocr"===C?this.updateOcrData():"changeMobile"===C?this.updateMobile():"resetTradePassword"===C&&this.doNoticeAuthCheck()},updateMobile:function(){},updateOcrData:function(){},uploadFile:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var a,n,i,o,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.$track.setInputTime("face_recognition_time"),e.$track.setCacheData("collData"),e.$track.setCountData("face_recognition_times"),t.prev=4,a=e.$track.getVrifyData(),n=wx.getStorageSync("userInfo"),i={event_code:"biopsy",eventType:"10",mobile:n.mobile,uuid:n.uuid?n.uuid:"",idNumber:n.certNo?n.certNo:"",name:n.name?n.name:"",face_recognition_times:"1"},i.event_code="sbt_bioassay",i.resource_value="sbt_bioassay",i.resource_type="submit",o=(0,r.default)((0,r.default)({},a),i),s={fraudContent:JSON.stringify(o)},"loan"===C?s.busType="01":"bindCard"===C?s.busType="02":"unbindCard"===C&&(s.busType="8"),s.newColl=!0,t.next=17,e.uploadLifeVideo(s);case 17:u=t.sent,c.default.log("uploadFile result:::::::::"),c.default.log(u),uni.hideLoading(),u?u.isError?(c.default.alert({content:"获取token 失败"}),uni.$emit("fail",{msg:"页面更新"})):"1000"===u.code?(e.$track.setData({resource_value:"finish_vidio"}),e.doSuccess(u)):"loan"===C?uni.$emit("fail",{msg:"loan"}):"bindCard"===C?uni.$emit("fail",{msg:"bindCard"}):uni.$emit("fail",{msg:u.message}):"loan"===C?uni.$emit("fail",{msg:"loan"}):"bindCard"===C?uni.$emit("fail",{msg:"bindCard"}):uni.$emit("fail",{msg:"页面更新"}),e.$track.setStartTime("face_recognition_time"),t.next=30;break;case 25:t.prev=25,t.t0=t["catch"](4),e.loading=!1,uni.hideLoading(),uni.$emit("fail",{msg:"页面更新"});case 30:e.loading=!1,uni.hideLoading();case 32:case"end":return t.stop()}}),t,null,[[4,25]])})))()},doNoticeAuthCheck:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.noticeAuthCheck({type:"no"});case 2:a=t.sent,a?uni.$emit("success",{msg:k,type:"1"}):uni.$emit("fail",{msg:"页面更新"});case 4:case"end":return t.stop()}}),t)})))()}})};t.default=_},e60f:function(e,t,a){"use strict";var n=a("6061"),i=a.n(n);i.a},e8b6:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,'.check-msg[data-v-b5904f6a]{height:%?608?%;background:#fff}.title[data-v-b5904f6a]{\n    /* height: 145upx;\n\t\tline-height: 145upx; */text-align:center;margin-top:%?80?%}.intro[data-v-b5904f6a]{display:flex;align-items:center;justify-content:center;\n    /* width: 311upx; */height:%?311?%\n    /* justify-content: space-around; */}.intro>uni-image[data-v-b5904f6a]{width:%?311?%;height:%?311?%}.desc[data-v-b5904f6a]{width:%?360?%}.ul>.li[data-v-b5904f6a]{line-height:%?66?%;padding-left:%?40?%;position:relative}.li[data-v-b5904f6a]:before{top:%?23?%;left:0;width:%?20?%;height:%?20?%;display:block;position:absolute;content:" ";border-radius:50%;background-color:#b2b2b2}.number[data-v-b5904f6a]{height:%?150?%;line-height:%?150?%;text-align:center}.p[data-v-b5904f6a]{font-size:%?74?%;font-weight:700;letter-spacing:%?20?%;margin-left:%?20?%}.submit-btn-wrap[data-v-b5904f6a]{margin-top:%?60?%}',""]),e.exports=t}}]);